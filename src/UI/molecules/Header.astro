---
import { Image } from 'astro:assets';
import logo from '../../assets/img/logo.svg';
import menu from '../../assets/img/menu.svg';
---

<header
	id='header'
	class='flex justify-between items-center w-full pt-2 sm:p-[20px] sm:px-[40px] font-bold fixed top-0 z-20 transition-transform duration-300'
>
	<Image
		src={logo}
		alt='logo de Cristian Montoya'
		class='w-[60px] h-[60px] sm:w-[69px] sm:h-[69px] ml-[10px]'
		loading='eager'
		draggable='false'
	/>
	<nav id='nav'>
		<Image
			src={menu}
			alt='icono menu'
			class='w-[48px] h-[48px] sm:hidden mr-[10px]'
			loading='eager'
			draggable='false'
		/>
		<div class='flex-row gap-x-[30px] text-[32px] hidden sm:flex'>
			<a
				href='#home'
				class='nav-link blue-text rounded-full px-5 hover:bg-[#121427]/50 hover:shadow-[0px_0px_18px_0px_#43CFF4]'
				>Home</a
			>
			<a
				href='#experience'
				class='nav-link blue-text rounded-full px-5 hover:bg-[#121427]/50 hover:shadow-[0px_0px_18px_0px_#43CFF4]'
				>Experience</a
			>
			<a
				href='#about-me'
				class='nav-link blue-text rounded-full px-5 hover:bg-[#121427]/50 hover:shadow-[0px_0px_18px_0px_#43CFF4]'
				>About me</a
			>
			<a
				href='#projects'
				class='nav-link blue-text rounded-full px-5 hover:bg-[#121427]/50 hover:shadow-[0px_0px_18px_0px_#43CFF4]'
				>Projects</a
			>
		</div>
	</nav>
</header>

<script>
	function handleHeaderScroll() {
		let lastScrollTop = 0;
		const header = document.getElementById('header');

		return () => {
			const scrollTop = window.pageYOffset || document.documentElement.scrollTop;

			if (scrollTop <= 100) {
				header?.classList.remove('-translate-y-full');
				header?.classList.remove('backdrop-blur-md', 'shadow-lg');
				return;
			}

			header?.classList.add('backdrop-blur-md', 'shadow-lg');

			if (scrollTop > lastScrollTop) {
				header?.classList.add('-translate-y-full');
			} else {
				header?.classList.remove('-translate-y-full');
			}

			lastScrollTop = scrollTop;
		};
	}
	// Función para manejar la selección de enlaces del nav
	function handleNavSelection() {
		const navLinks = document.querySelectorAll('.nav-link');

		navLinks.forEach((link) => {
			link.addEventListener('click', function (this: HTMLElement, e: Event) {
				navLinks.forEach((l) => {
					l.classList.remove('bg-[#121427]/50', 'shadow-[0px_0px_18px_0px_#43CFF4]');
				});
				this.classList.add('bg-[#121427]/50', 'shadow-[0px_0px_18px_0px_#43CFF4]');
			});
		});
	}

	window.addEventListener('scroll', handleHeaderScroll());
	document.addEventListener('DOMContentLoaded', handleNavSelection);
</script>
